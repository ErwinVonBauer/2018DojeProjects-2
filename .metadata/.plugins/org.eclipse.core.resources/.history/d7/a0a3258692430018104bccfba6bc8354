package com.groupware.service;

import javax.servlet.http.HttpServletRequest;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.web.servlet.ModelAndView;
import com.groupware.dao.DraftDao;
import com.groupware.dao.UserDao;
import com.groupware.vo.DraftVo;

@Service
public class DraftService {
	@Autowired DraftDao draftdao;
	@Autowired UserDao userdao;
	@Autowired CommonService commonservice;
	
	public ModelAndView selectdoc(HttpServletRequest req) {
		String url = req.getRequestURL().toString();
		int doccount = draftdao.selectDocCount(); //문서개수
		String[] docs = draftdao.selectDocs(); //문서명
		
		System.out.println("selected docs:::"+doccount);
		for(int i=0;i<docs.length;i++) {
			System.out.println((i+1)+"번째 문서:::"+docs[i]);
		}
		
		ModelAndView view = new ModelAndView();
		view.setViewName("/draftdoc");
		view.addObject("doccount",doccount);
		view.addObject("docs",docs);
		return view;
	}
	
	public ModelAndView insertdoc(DraftVo draftvo, String viewName) {
		ModelAndView model = new ModelAndView();
		model.setViewName(viewName);
		model.addObject("vo",draftvo);
		
		System.out.println(draftvo.toString());
		System.out.println("success");
		draftdao.insertDoc(draftvo);
		return model;
	}
	
	public ModelAndView adduserinfo() {
		String loginedid = commonservice.getSession("id");
		
		String userai = userdao.selectUserPK(loginedid);
		String depai = userdao.selectDepPK(loginedid);
		String rankai = userdao.selectRankPK(loginedid);
		
		ModelAndView view = new ModelAndView();
		view.setViewName("/writedoc");
		view.addObject("userai",userai);
		view.addObject("depai",depai);
		view.addObject("rankai",rankai);
		System.out.println("selected infos:::"+userai+","+depai+","+rankai);
		return view;
	}
}
